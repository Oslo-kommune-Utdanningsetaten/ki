{% extends "header.html" %}

{% block title %}
  {{config['SITENAME']}}
{% endblock %}

{% block content %}

<div id="bot_page" v-cloak>

  <div id="bot_nr" hidden>{{bot_nr}}</div>
  <div v-if="bot">
    <h1 class="h2">
      ${ bot.title }
    </h1>
    <p>
      ${ bot.ingress }
    </p>

    <div class="card border-dark">
      <ul class="list-group list-group-flush">
        <span v-for="(message_line, msg_nr) in messages" :key="msg_nr">
          <li v-if="message_line.role != 'system'" class="container-fluid list-group-item response" :class="message_line.role">
            <span class="row">
              <div class="col-1 avatar">
                <img v-if="message_line.role === 'user'" src="{{ url_for('static', filename='img/user.svg') }}" alt="du:">
                <img v-else src="{{ url_for('static', filename='img/oslobot.svg') }}" alt="bot:">
              </div>
              <div class="col">
                <span v-html="message_line.content" class="chat" :class="msg_nr === messages.length - 1 && showTypeWriter ? 'type-writer' : ''" >
                </span>
              </div>
              <div class="col-1 edit-link invisible">
                <a v-if="message_line.role === 'user'" href="#" @click="editPrompt(msg_nr)">
                  <img src="{{ url_for('static', filename='img/rediger.svg') }}" alt="rediger">
                </a>
              </div>
            </span>
          </li>
        </span>
      </ul>
    </div>
    <div id="input_line" class="mt-3">
      <textarea id="text-input" type="text" rows="5" aria-label="Skriv her. Ikke legg inn personlige og sensitive opplysninger." v-model="message" class="form-control" placeholder="Skriv her. Ikke legg inn personlige og sensitive opplysninger." @keypress.enter.exact="sendMessage()"></textarea>
      <div class="card">
      <div class="card-body bg-body-tertiary">
        <button class="btn oslo-btn-primary" type="button" id="button-send" @click="sendMessage()">Send</button>
        <button class="btn oslo-btn-secondary" type="button" id="button-new" @click="newThread()">Ny samtale</button>
        <div><small>Husk at en AI ikke er et menneske og kan skrive ting som ikke stemmer med virkeligheten, og den gir ikke beskjed om når den gjør det.</small></div>
      </div>
      </div>
    </div>
    <div>
      &nbsp;
    </div>

  </div>
</div>
{% endblock %}

{% block scripts %}
  <script src="{{url_for('static', filename='js/scripts.js')}}"></script>
{% endblock %}
