{% extends "ki/header.html" %}

{% block title %}
  {{ sitename }}
{% endblock %}

{% block content %}

  <h3>Innstillinger for installasjonen</h3>

  <div class="card">
    <div class="card-body">
      <form method="post">
        <input type="hidden" name="csrfmiddlewaretoken" value="{{ csrf_token }}">
        {% for setting in settings %}
        <div class="form-group row">
          <label for="{{ setting.setting_key }}" class="col-sm-3 col-form-label">{{ setting.label }}:</label>
          <div class="col-sm-3">
            {% if setting.is_txt %}
            <input type="text" id="{{ setting.setting_key }}" class="form-control" name="{{ setting.setting_key }}" value="{{ setting.txt_val }}">
            {% else %}
            <input type="number" id="{{ setting.setting_key }}" class="form-control" name="{{ setting.setting_key }}" value="{{ setting.int_val }}">
            {% endif %}
          </div>
        </div>
        {% endfor %}
        
        <div class="row mt-3">
          <div class="col-4"><strong>Skole</strong></div>
          <div class="col-1"><strong>Ikke tilgang</strong></div>
          <div class="col-1"><strong>Alle</strong></div>
          <div class="col-1"><strong>Kun lærere</strong></div>
          <div class="col"><strong>Enkelte trinn</strong></div>
        </div>
        {% for school in schools %}
        <div class="row">
          <div class="col-4">
            {{ school.school_name}}

          </div>
          <div class="col-1">
            <input class="form-check-input" onclick="hideLevel('{{school.org_nr}}')" type="radio" name="acc_{{school.org_nr}}" value="none" {{'checked' if school.access == 'none'}} aria-label="{{school.school_name}}+' ingen'" >
          </div>
          <div class="col-1">
            <input class="form-check-input" onclick="hideLevel('{{school.org_nr}}')" type="radio" name="acc_{{school.org_nr}}" value="all" {{'checked' if school.access == 'all'}} aria-label="{{school.school_name}}+' alle'" >
          </div>
          <div class="col-1">
            <input class="form-check-input" onclick="hideLevel('{{school.org_nr}}')" type="radio" name="acc_{{school.org_nr}}" value="emp" {{'checked' if school.access == 'emp'}} aria-label="{{school.school_name}}+' kun lærere'" >
          </div>
          <div class="col">
            <input class="form-check-input" onclick="showLevel('{{school.org_nr}}')" type="radio" name="acc_{{school.org_nr}}" value="levels" {{'checked' if school.access == 'levels'}} aria-label="{{school.school_name}}+' enkelte trinn'" >
            <span id="lev_{{school.org_nr}}" style="display: {{'' if school.access == 'levels' else 'none'}};">
              <select name="lev_{{school.org_nr}}" class="levelselect chosen-select" multiple data-placeholder="Velg trinn" aria-label="multiple select example">
                {% for level in school.levels %}
                  <option value="{{level.code}}" {{ level.selected }} >{{ level.text }}</option>
                {% endfor %}
              </select>
            </span>
          </div>
        </div>
        {% endfor %}

        
        
        
        <button type="submit" class="btn oslo-btn-primary" name="save_settings" value="ok"> Lagre endringer</button>
        <a href="{{ url('main.index') }}" type="button" class="btn oslo-btn-secondary" >Avbryt</a>
        
      </form>
    </div>
  </div>

{% endblock content %}

{% block scripts %}
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.jquery.min.js"></script>
  <link href="https://cdn.rawgit.com/harvesthq/chosen/gh-pages/chosen.min.css" rel="stylesheet"/>

  <script>
    $(".chosen-select").chosen({width: "90%"})
    function hideLevel(school){ 
      document.getElementById("lev_"+school).style.display ='none';
    }
    function showLevel(school){
      document.getElementById("lev_"+school).style.display ='';
    }

</script>
  
{% endblock %}
